"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[946],{365182:(e,t,r)=>{var o,s,n,a=(n=r(302543))&&n.__esModule?n:{default:n},i=r(428409);o=[r(851274),r(552113),r(680177),r(467778)],void 0===(s=function(e,t,r){let o=t.Browser=t.Browser||{};return o.Collection||(o.Collection=function(){},a.default.extend(o.Collection,a.default.clone(o.Node),{Init:function(){this.node_initialized||(this.node_initialized=!0,t.Browser.add_menus([{name:"refresh",node:this.type,module:this,applies:["object","context"],callback:"refresh",priority:2,label:e("Refresh"),shortcut_preference:["browser","sub_menu_refresh"]}]),t.unsupported_nodes&&-1==a.default.indexOf(t.unsupported_nodes,this.type)&&("database"==this.type&&this.allowConn||"database"!=this.type)&&(t.Browser.add_menus([{name:"show_query_tool",node:this.type,module:this,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool"),permission:i.AllPermissionTypes.TOOLS_QUERY_TOOL,shortcut_preference:["browser","sub_menu_query_tool"]}]),t.Browser.add_menus([{name:"search_objects",node:this.type,module:this,applies:["context"],callback:"show_search_objects",priority:997,label:e("Search Objects..."),permission:i.AllPermissionTypes.TOOLS_SEARCH_OBJECTS,shortcut_preference:["browser","sub_menu_search_objects"]}]),t.enable_psql&&t.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:e("PSQL Tool"),permission:i.AllPermissionTypes.TOOLS_PSQL_TOOL}])))},hasId:!1,is_collection:!0,collection_node:!0,hasCollectiveStatistics:!0,canDrop:!0,canDropCascade:!0,selectParentNodeOnDelete:!1,generate_url:function(e,s){let n={properties:"obj",children:"nodes",drop:"obj"},a=this,i=o.tree.getTreeNodeHierarchy(e),l=s in n?n[s]:s;return r.generate_url(t.Browser.URL,i,l,a.node,function(e,t){return t!=a.type})},show_query_tool:function(){t.Tools.SQLEditor&&t.Tools.SQLEditor.showQueryTool("",t.Browser.tree.selected())},show_search_objects:function(){t.Tools.SearchObjects&&t.Tools.SearchObjects.show_search_objects("",t.Browser.tree.selected())},show_psql_tool:function(e){let t=e||{},r=o.tree,s=t.item||r.selected(),n=s?r.itemData(s):void 0;o.psql.psql_tool(n,s,!0)}})),o.Collection}.apply(t,o))||(e.exports=s)},467778:(e,t,r)=>{var o,s,n=_(r(302543)),a=_(r(516755)),i=r(428409),l=_(r(656085)),c=_(r(220965)),d=_(r(175179)),p=_(r(369189)),u=r(137480),f=r(474848);function _(e){return e&&e.__esModule?e:{default:e}}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function y(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}o=[r(851274),r(552113),r(680177),r(137480),r(391849),r(860847)],void 0===(s=function(e,t,r,o){const s=t.Browser=t.Browser||{};return s.Node?s.Node:(s.Nodes=s.Nodes||{},s.Node=function(){},s.Node.extend=function(e,t){let r,o=this;if(r=function(){return o.apply(this,arguments)},n.default.extend(r,o,n.default.omit(e,"callbacks")),r.callbacks=n.default.extend({},o.callbacks,e.callbacks),!(t??1))return r;let s=function(e){"function"==typeof r.callbacks[e]&&(r.callbacks[e]=r.callbacks[e].bind(r))},a=n.default.keys(r.callbacks);for(let e of a)s(e);return r.Init.apply(r),this.Init.apply(r),r},n.default.extend(t.Browser.Node,{type:void 0,label:"",sqlAlterHelp:"",sqlCreateHelp:"",dialogHelp:"",epasHelp:!1,title:function(t,r){return"create"==r?e("Create - %s",this.label):t._label??""},copy:function(e){return e},getNodeInfoLabel:function(e){return e.info_label?e.info_label:null},hasId:!0,Init:function(){let r=this;if(!r.node_initialized){if(r.node_initialized=!0,t.Browser.add_menus([{name:"refresh",node:r.type,module:r,applies:["object","context"],callback:"refresh",priority:2,label:e("Refresh..."),shortcut_preference:["browser","sub_menu_refresh"],enable:!0}]),r.canEdit&&t.Browser.add_menus([{name:"show_obj_properties",node:r.type,module:r,applies:["object","context"],callback:"show_obj_properties",priority:999,label:e("Properties..."),data:{action:"edit"},shortcut_preference:["browser","sub_menu_properties"],enable:n.default.isFunction(r.canEdit)?function(){return!!r.canEdit(...arguments)}:!!r.canEdit,permission:"server"==r.type?i.AllPermissionTypes.OBJECT_REGISTER_SERVER:void 0}]),r.canDrop&&(t.Browser.add_menus([{name:"delete_object",node:r.type,module:r,applies:["object","context"],callback:"delete_obj",priority:r.dropPriority,label:r.dropAsRemove?e("Remove %s",r.label):e("Drop"),data:{url:"drop",data_disabled:e("The selected tree node does not support this option.")},shortcut_preference:["browser","sub_menu_delete"],enable:n.default.isFunction(r.canDrop)?function(){return!!r.canDrop(...arguments)}:!!r.canDrop,permission:"server"==r.type?i.AllPermissionTypes.OBJECT_REGISTER_SERVER:void 0}]),r.canDropCascade&&t.Browser.add_menus([{name:"delete_object_cascade",node:r.type,module:r,applies:["object","context"],callback:"delete_obj",priority:2,label:e("Drop (Cascade)"),data:{url:"delete"},enable:n.default.isFunction(r.canDropCascade)?function(){return r.canDropCascade(...arguments)}:!!r.canDropCascade}])),-1==n.default.indexOf(t.unsupported_nodes,r.type)){let o=function(e){return!("database"!=e?._type||!e?.allowConn)||"database"!=e?._type};t.Browser.add_menus([{name:"show_query_tool",node:r.type,module:r,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool"),enable:o,permission:i.AllPermissionTypes.TOOLS_QUERY_TOOL,shortcut_preference:["browser","sub_menu_query_tool"]}]),t.Browser.add_menus([{name:"search_objects",node:r.type,module:t.Tools.SearchObjects,applies:["context"],callback:"show_search_objects",priority:997,label:e("Search Objects..."),icon:"fa fa-search",enable:o,permission:i.AllPermissionTypes.TOOLS_SEARCH_OBJECTS,shortcut_preference:["browser","sub_menu_search_objects"]}]),t.enable_psql&&t.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:e("PSQL Tool"),permission:i.AllPermissionTypes.TOOLS_PSQL_TOOL}])}r.hasScriptTypes&&n.default.isArray(r.hasScriptTypes)&&r.hasScriptTypes.length>0&&n.default.each(r.hasScriptTypes,function(o){let s=e("%s Script",o.toUpperCase());o=o.toLowerCase(),t.Browser.add_menus([{name:"show_script_"+o,node:r.type,module:r,applies:["object","context"],callback:"show_script",priority:4,label:s,category:e("Scripts"),data:{script:o,data_disabled:e("The selected tree node does not support this option.")},enable:r.check_user_permission,permission:i.AllPermissionTypes.TOOLS_QUERY_TOOL}])})}},check_user_permission:function(e,t,r){if("server_group"==e._type||"server"==e._type)return!1;if("database"==e._type&&!e.allowConn)return!1;let o=s.tree.getTreeNodeHierarchy(t);return-1==n.default.indexOf(["create","insert","update","delete"],r.script)||(!("role"!=e.type||!o.server.user.can_create_role)||!!(o.server?.user.is_superuser||o.server?.user.can_create_db||o.schema?.can_create))},hasScriptTypes:["create"],canEdit:!0,canDrop:!1,canDropCascade:!1,dropAsRemove:!1,dropPriority:2,selectParentNodeOnDelete:!1,callbacks:{show_obj_properties:function(r,a){let l=s.tree,c=r?.item||a||l.selected(),d=c?l.itemData(c):void 0,p=this.title(d,r.action),u=s.tree.getTreeNodeHierarchy(c);if(!d)return;const f=n.default.isArray(this.parent_type)?e=>-1!=n.default.indexOf(this.parent_type,e._type):e=>this.parent_type==e._type;if("create"==r.action){if(this.parent_type&&!f(d))for(;c&&l.hasParent(c);){c=l.parent(c);let e=l.itemData(c);if(f(e)){d=e;break}}if(!d||null!=this.parent_type&&!f(d))return;u=s.tree.getTreeNodeHierarchy(c);const e=n.default.uniqueId(i.BROWSER_PANELS.EDIT_PROPERTIES),t=(t=!1)=>{s.docker.default_workspace.close(e,t)},r=e=>{setTimeout(()=>{this.clear_cache(a)},0);try{s.Events.trigger("pgadmin:browser:tree:add",n.default.clone(e.node),n.default.clone(u))}catch(e){console.warn(e.stack||e)}t()};this.showPropertiesDialog(e,p,{treeNodeInfo:u,item:c,nodeData:d,actionType:"create",onSave:r,onClose:t})}else if("copy"==r.action){u=s.tree.getTreeNodeHierarchy(c);const e=n.default.uniqueId(i.BROWSER_PANELS.EDIT_PROPERTIES),t=(t=!1)=>{s.docker.default_workspace.close(e,t)},r=e=>{setTimeout(()=>{this.clear_cache(a)},0);try{s.Events.trigger("pgadmin:browser:tree:add",n.default.clone(e.node),{server_group:u.server_group})}catch(e){console.warn(e.stack||e)}t()};this.showPropertiesDialog(e,p,{treeNodeInfo:u,item:c,nodeData:d,actionType:"copy",onSave:r,onClose:t})}else{const n=i.BROWSER_PANELS.EDIT_PROPERTIES+d.id,l=(e=!1)=>{s.docker.default_workspace.close(n,e)},f=e=>{let t=d,r=e.node,o=u;setTimeout(()=>{this.clear_cache(a)},0),s.Events.trigger("pgadmin:browser:tree:update",t,r,o,{success:function(e,t,r){s.Events.trigger("pgadmin:browser:node:updated",e,t,r),s.Events.trigger("pgadmin:browser:node:"+t._type+":updated",e,t,r)}}),l()};if(s.docker.default_workspace.find(n)){let s=e('Are you sure want to stop editing the properties of %s "%s"?');"edit"==r.action&&(s=e('Are you sure want to reset the current changes and re-open the panel for %s "%s"?')),t.Browser.notifier.confirm(e("Edit in progress?"),o.sprintf(s,this.label.toLowerCase(),d.label),()=>{this.showPropertiesDialog(n,p,{treeNodeInfo:u,item:c,nodeData:d,actionType:"edit",onSave:f,onClose:l},!0)},null)}else this.showPropertiesDialog(n,p,{treeNodeInfo:u,item:c,nodeData:d,actionType:"edit",onSave:f,onClose:l})}},delete_obj:function(r,o){let i=r||{url:"drop"},l=this,c=s.tree,d=i.item||o||c.selected(),p=d?c.itemData(d):void 0;if(!p)return;l=s.Nodes[p._type];let u,f,_=n.default.unescape(p.label);if("delete"==i.url&&"database"===p._type)u=e('Drop database with the force option will attempt to terminate all existing connections to the <b>"%s"</b> database. Are you sure you want to proceed?',p.label),f=e("Drop FORCE %s?",l.label);else if("delete"==i.url){if(u=e('Are you sure you want to drop the %s <b>"%s"</b> and all the objects that depend on it?',l.label.toLowerCase(),p.label),f=e("Drop CASCADE %s?",l.label),!(n.default.isFunction(l.canDropCascade)?l.canDropCascade(p,d):l.canDropCascade))return void t.Browser.notifier.error(e('The %s "%s" cannot be dropped.',l.label,p.label),1e4)}else if(l.dropAsRemove?(u=e('Are you sure you want to remove the %s <b>"%s"</b>?',l.label.toLowerCase(),p.label),f=e("Remove %s?",l.label)):(u=e('Are you sure you want to drop the %s <b>"%s"</b>?',l.label.toLowerCase(),p.label),f=e("Drop %s?",l.label)),!(n.default.isFunction(l.canDrop)?l.canDrop(p,d):l.canDrop))return void t.Browser.notifier.error(e('The %s "%s" cannot be dropped/removed.',l.label,p.label),1e4);t.Browser.notifier.confirmDelete(f,u,function(){(0,a.default)().delete(l.generate_url(d,i.url,p,!0)).then(({data:e})=>{if(2!=e.success){if(0==e.success)t.Browser.notifier.alert(e.errormsg,e.info);else{let e=!0;if(l.selectParentNodeOnDelete){let t=c.parent(d);setTimeout(function(){c.select(t)},10),e=!1}if(l.refreshParent?.(d))return void l.callbacks.refresh("refresh",c.parent(d));s.removeTreeNode(d,e)}return!0}t.Browser.notifier.error(e.info,null)}).catch(function(r){let o=r.request?.responseText;if(417==r.request?.status||410==r.request?.status||500==r.request?.status)try{let e=r.response.data;o=e.info||e.errormsg}catch(e){console.warn(e.stack||e)}t.Browser.notifier.alert(e('Error dropping/removing %s: "%s"',l.label,_),o)})},()=>{},l.dropAsRemove?e("Remove"):e("Drop"),e("Cancel"))},show_script:function(e,r){let o,n,a=e.script,i=s.tree,l=r||i.selected(),c=l?i.itemData(l):void 0;c&&(o=s.Nodes[c._type],n="insert"==a?"insert_sql":"update"==a?"update_sql":"delete"==a?"delete_sql":"select"==a?"select_sql":"exec"==a?"exec_sql":"sql",t.Tools.SQLEditor.showQueryTool(o.generate_url(l,n,c,!0),l,a))},show_query_tool:function(r,o){let n=p.default.getState().getPreferences("sqleditor","copy_sql_to_query_tool"),a=s.tree,i=o||a.selected(),l=i?a.itemData(i):void 0;if(l)if(n.value&&!l._type.includes("coll-")){let t={script:l._type.toLowerCase(),data_disabled:e("The selected tree node does not support this option.")};s.Node.callbacks.show_script(t)}else t.Tools.SQLEditor.showQueryTool("",i)},show_psql_tool:function(e){let r=e||{},o=s.tree,n=r.item||o.selected(),a=n?o.itemData(n):void 0;t.Tools.Psql.openPsqlTool(a,n)},change_server_background:function(e,t){if(!e||!t)return;const r=s.tree.getTreeNodeHierarchy(e).server;if(!r)return;if(-1!==e.path.indexOf(r.id)){let t=r.icon.split(" ")[1]||null,o=r.icon.split(" ")[2]||"";if(t){let n="pga_server_"+r._id+"_bgcolor";const a=document.createElement("style");a.setAttribute("id",n),a.setAttribute("type","text/css"),a.innerText=`\n              .${n} .file-label {\n                border-radius: 3px;\n                margin-bottom: 2px;\n                background: ${t} !important;\n              }\n              ${o?`\n              .${n} span.file-name, .${n} span.file-name:hover, .${n} span.file-name.pseudo-active {\n                color: ${o} !important;\n              }\n              `:""}\n            `,document.querySelector(`style[id="${n}"]`)?.remove(),document.head.appendChild(a),s.tree.addCssClass(e,n)}}},added:function(e,r){-1!==s.tree.getData(e)._type.indexOf("coll-")&&setTimeout(function(){let r=t.Browser.Nodes[s.tree.getData(e).nodes[0]];r.clear_cache.apply(r)},0),s.Node.callbacks.change_server_background(e,r);const o=s.tree.suppressEventsForPath;if(o){if(e.path!==o)return;s.tree.suppressEventsForPath=null}s.Events.trigger("pgadmin:browser:tree:expand-from-previous-tree-state",e)},selected:function(e,r){return t.Browser.enable_disable_menus.apply(s,[e]),s.Events.trigger("pgadmin-browser:node:selected",e,r),s.Events.trigger("pgadmin:browser:tree:update-tree-state",e),!0},deselected:function(){t.Browser.enable_disable_menus.apply(s,[])},removed:function(e){let t=this;setTimeout(function(){t.clear_cache(e)},0)},refresh:function(e,t){let r=this,o=s.tree,n=t&&o.itemData(t);s.Events.trigger("pgadmin:browser:tree:refresh",t||s.tree.selected(),{success:function(){r.callbacks.selected.apply(r,[t,n,s])}})},opened:function(e){let t=s.tree,r=p.default.getState().getPreferences("browser","auto_expand_sole_children");const o=s.tree.suppressEventsForPath;if(o){if(e.path!==o)return;s.tree.suppressEventsForPath=null}if(r?.value&&1==t.children(e).length){const r=t.first(e);if(r._loaded)t.open(r),t.select(r);else{const e=setInterval(()=>{r._loaded&&(t.open(r),t.select(r),o())},200),o=function(){clearInterval(e)}}}else if(1==t.children(e).length){const r=t.first(e);t.select(r)}s.Events.trigger("pgadmin:browser:tree:update-tree-state",e)},closed:function(e){s.Events.trigger("pgadmin:browser:tree:remove-from-tree-state",e)}},showPropertiesDialog:function(e,t,r,o=!1){const n={id:e,title:t,manualClose:!0,icon:`dialog-node-icon ${(0,u.evalFunc)(this,this.node_image,r.nodeData)??"icon-"+this.type}`,content:(0,f.jsx)(c.default,{children:(0,f.jsx)(l.default,b({panelId:e,node:this,formType:"dialog"},r))})};let a=(0,d.default)(this.width||s.stdW.default+"px","width",!0),i=(0,d.default)(this.height||s.stdH.default+"px","height",!0);a=a<=s.stdW.sm?s.stdW.sm:a<=s.stdW.md?s.stdW.md:s.stdW.lg,i=i<=s.stdH.sm?s.stdH.sm:i<=s.stdH.md?s.stdH.md:s.stdH.lg,o?(r.onClose(!0),setTimeout(()=>{s.docker.default_workspace.openDialog(n,a,i)},10)):s.docker.default_workspace.openDialog(n,a,i)},_find_parent_node:function(e,t,r){if(this.parent_type)if(r=r||e.itemData(t),n.default.isString(this.parent_type)){if(this.parent_type==r._type)return t;for(;e.hasParent(t);)if(t=e.parent(t),r=e.itemData(t),this.parent_type==r._type)return t}else{if(n.default.indexOf(this.parent_type,r._type)>=0)return t;for(;e.hasParent(t);)if(t=e.parent(t),r=e.itemData(t),n.default.indexOf(this.parent_type,r._type)>=0)return t}return null},generate_url:function(e,t,o,a,i,l){let c={create:"obj",drop:"obj",edit:"obj",properties:"obj",statistics:"stats"},d=this,p=-1/0,u=n.default.isUndefined(e)||n.default.isNull(e)?i||{}:s.tree.getTreeNodeHierarchy(e),f=t in c?c[t]:t,_=a&&o._type==d.type?encodeURIComponent(o._id):"";if(d.parent_type)if(n.default.isString(d.parent_type)){let e=u[d.parent_type];e&&(p=e.priority)}else n.default.each(d.parent_type,function(e){let t=u[e];t&&p<t.priority&&(p=t.priority)});let h=p;l&&u[l]&&(h=u[l].priority);return r.generate_url(s.URL,u,f,d.type,function(e){return e.priority<=h||e.priority==p},_)},cache:function(e,t,r,s){let a=this.cached=this.cached||{},i=e,l=t?.[r]?.priority||0;if(t&&n.default.each(n.default.sortBy(n.default.values(n.default.pickBy(t,function(e){return e.priority<=l})),function(e){return e.priority}),function(e){i=o.sprintf("%s_%s",i,encodeURI(e._id))}),n.default.isUndefined(s)){let e=a[i];return!n.default.isUndefined(e)&&e.at-Date.now()>3e5&&(e=void 0),e}return a[i]={data:s,at:Date.now(),level:r}},clear_cache:function(e){this.cached={};s.Events.trigger("pgadmin:browser:node:"+this.type+":cache_cleared",e,this)},cache_level:function(e,t){if(e){if(t&&this.type in e)return this.type;if(n.default.isArray(this.parent_type)){for(let t in this.parent_type)if(t in e)return t;return this.type}return this.parent_type}}}),t.Browser.Node)}.apply(t,o))||(e.exports=s)},860847:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(912061)),s=n(r(552113));function n(e){return e&&e.__esModule?e:{default:e}}const a=s.default.Browser=s.default.Browser||{};a.Events=new o.default;t.default=a}}]);